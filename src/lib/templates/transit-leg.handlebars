<div class="otp-leg localize">
  <div class="otp-legHeader open">
        <!--        TODO ADD TRANSLATION and make change to MORE-->
        <span class="less-more less">&minus; Less</span>
        <span class="less-more more">&plus; More</span>

        <span class="agency-descriptor-span"><b><a target="_blank" href="{{agencyUrl}}">{{agencyName}}</a></b></span>

        <div>
            <span class="transit-line-container">
                <span class="transit-line-well"
                    {{#if routeColor }}
                        {{#if routeTextColor }}
                      style="background-color: #{{routeColor}}; color: #{{routeTextColor}};"
                        {{/if}}
                    {{/if}}
                >

                </span>
                {{#if (isAnyCallAndRide) }}
                    <div class="otp-legMode-glyphicon"><span class="glyphicon glyphicon-earphone"></span></div>
                {{else}}
                    <div class="otp-legMode-icon otp-legMode-icon-{{ mode }}"></div>
                {{/if}}

                {{#if routeShortName}}
                    <b>{{routeShortName}}</b>
                {{else}}
                    <b>{{routeLongName}}</b>
                {{/if}}
            </span>
                {{#if headsign}}
                   <span data-i18n="handlebars.to"></span> {{headsign}}
                {{/if}}
        </div>

    </div>
        </span>
  {{#each alerts}}
        <div class="alert alert-warning">{{alertDescriptionText}}</div>
  {{/each}}
    <div class="otp-legBody">
        <div class="otp-legBody-from">
            {{#if (hasFromTransitMessage) }}
                <span class="col-xs-2 col-md-2" id="from_leg_narrative_depart">
            {{else}}
                <span class="col-xs-4 col-md-4" id="from_leg_narrative_depart">
            {{/if}}
                <div>
                    <span class="narrative-depart-arrival-text" data-i18n="handlebars.depart">

                    </span>
                    <span class="narrative-depart-arrival-time">
                        {{#if (hasflexCallAndRideMaxStartTime )}}
                            <span class="timing_text" data-i18n="handlebars.apprx"></span> {{formatTimeWithflexCallAndRideMaxStartTime startTime flexCallAndRideMaxStartTime timeOffset}}
                        {{else}}
                            {{formatTime startTime timeOffset}}
                        {{/if}}
                    </span>
                </div>
            </span>
            {{#if (hasFromTransitMessage) }}
                <span class="col-xs-4 col-md-4" id="from_leg_narrative_from">
            {{else}}
                <span class="col-xs-8 col-md-8" id="from_leg_narrative_depart">
            {{/if}}
                <div>
                    <span class="narrative-from-to-text" data-i18n="handlebars.from"></span>
                    <span class="narrative-from-to-location">
                        {{from.name}}
                        {{#if from.stopId.id}}
                            <span data-i18n="handlebars.stopNum"></span> {{from.stopId.id}}
                        {{/if}}
                    </span>
                </div>
            </span>
<!--            TODO manage flag stops once we have examples-->
            {{#if (isFlagStop from.boardAlightType)}}
                <span class="col-xs-6 col-md-6" id="from_leg_narrative_flag_stop">
                    <div>
                        <h5 data-i18n="handlebars.flagStop"></h5>
                        {{#if (hasflexFlagStopPickupMessage)}}
                            {{flexFlagStopPickupMessage}}
                        {{else}}
                            {{flagStopPickupText}}
                        {{/if}}
                    </div>
                </span>
            {{/if}}

        </div>
        <br style="clear: both;">
        <div class="otp-legBody-to">
            {{#if (hasToTransitMessage) }}
                {{#if (hideDropoffDeviatedMessage) }}
                    <span class="col-xs-4 col-md-4" id="from_leg_narrative_depart">
                {{else}}
                    <span class="col-xs-2 col-md-2" id="from_leg_narrative_depart">
                {{/if}}

            {{else}}
                <span class="col-xs-4 col-md-4" id="from_leg_narrative_depart">
            {{/if}}
                <div>
                    <span class="narrative-depart-arrival-text" data-i18n="handlebars.arrive"></span>
                    <span class="narrative-depart-arrival-time">
                        {{#if (hasflexCallAndRideMinEndTime) }}
                            <span class="timing_text" data-i18n="handlebars.apprx"></span> {{formatTimeWithflexCallAndRideMinEndTime endTime flexCallAndRideMinEndTime timeOffset}}
                        {{else}}
                            {{formatTime endTime timeOffset}}
                        {{/if}}
                    </span>
                </div>
            </span>
            {{#if (hasToTransitMessage)}}
                {{#if (hideDropoffDeviatedMessage) }}
                    <span class="col-xs-8 col-md-8" id="from_leg_narrative_depart">
                {{else}}
                    <span class="col-xs-4 col-md-4" id="from_leg_narrative_from">
                {{/if}}

            {{else}}
                <span class="col-xs-8 col-md-8" id="from_leg_narrative_depart">
            {{/if}}
                <div>
                    <span class="narrative-from-to-text" data-i18n="handlebars.toUP"/>
                    <span class="narrative-from-to-location">
                        {{to.name}}

                    {{#if to.stopId.id}}
                            <span data-i18n="handlebars.stopNum"></span> {{to.stopId.id}}
                    {{/if}}
                    </span>
                </div>
            </span>
            {{#if (isFlagStop to.boardAlightType)}}
                <span class="col-xs-6 col-md-6" id="from_leg_narrative_flag_stop">
                    <div>
                        <h5 data-i18n="handlebars.flagStop"></h5>
                        {{#if (hasflexFlagStopDropOffMessage)}}
                            {{flexFlagStopDropOffMessage}}
                        {{else}}
                            {{flagStopDropOffText}}
                        {{/if}}
                    </div>
                </span>
            {{/if}}
        </div>
        {{#if (isCallAndRide from.boardAlightType) }}
                <div>
<!--                    TODO make the button work-->
                    Display the button and activate it like the arc does. This time using from stop information.
                </div>
        {{else}}
            {{#if (isCallAndRide to.boardAlightType) }}
                    <div>
                        <!--                    TODO make the button work-->
                        Display the button and activate it like the arc does. This time using to stop information.
                    </div>
            {{/if}}
        {{/if}}


    </div>
</div>
<br style="clear: both;">
<div></div>
<script>
  $(".localize").localize();
</script>