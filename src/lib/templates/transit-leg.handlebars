<div class="otp-leg">
  <div class="otp-legHeader" {{#if routeColor }}style="border-top:3px solid #{{routeColor}};" {{else}} style="border-top:3px solid #000;" {{/if}}>
    <div class="agencyBranding" style="background-image: url({{agencyLogoUrl}});"></div>
    <span class="agency-descriptor-span"><b><a target="_blank" href="{{agencyUrl}}">{{agencyName}}</a></b></span>
    <span class="transit-line-container">
        {{#if (isAnyCallAndRide) }}
            <div class="otp-legMode-glyphicon"><span class="glyphicon glyphicon-earphone"></span></div>
        {{else}}
            <div class="otp-legMode-icon otp-legMode-icon-{{ mode }}"></div>
        {{/if}}

          <span class="transit-line-well"
              {{#if routeColor }}
                {{#if routeTextColor }}
                    style="background-color: #{{routeColor}}; color: #{{routeTextColor}};"
                {{/if}}
              {{/if}}
          >
              {{#if routeShortName}}
                  <b>{{routeShortName}}</b>
              {{else}}
                  <b>{{routeLongName}}</b>
              {{/if}}
          </span>
          {{#if headsign}}
              <br /> to {{headsign}}
          {{/if}}

      </div>
    </span>
  {{#each alerts}}
    <div class="alert alert-warning">{{alertDescriptionText}}</div>
  {{/each}}
    <div class="otp-legBody">
        <div class="otp-legBody-from">
            {{#if (hasFromTransitMessage) }}
                <span class="col-xs-2 col-md-2" id="from_leg_narrative_depart">
            {{else}}
                <span class="col-xs-4 col-md-4" id="from_leg_narrative_depart">
            {{/if}}
                <div>
                    <h5>Depart</h5>
                    <div>
                        {{#if (hasflexCallAndRideMaxStartTime )}}
                            <span class="timing_text"> approximately </span> {{formatTimeWithflexCallAndRideMaxStartTime startTime flexCallAndRideMaxStartTime timeOffset}}
                        {{else}}
                            {{formatTime startTime timeOffset}}
                        {{/if}}
                    </div>
                </div>
            </span>
            {{#if (hasFromTransitMessage) }}
                <span class="col-xs-4 col-md-4" id="from_leg_narrative_from">
            {{else}}
                <span class="col-xs-8 col-md-8" id="from_leg_narrative_depart">
            {{/if}}
                <div>
                    <h5> From </h5>
                    <div>
                        {{from.name}}
                    </div>
                    {{#if from.stopId.id}}
                        <div>
                            Stop #{{from.stopId.id}}
                        </div>
                    {{/if}}
                </div>
            </span>
            {{#if (isFlagStop from.boardAlightType)}}
                <span class="col-xs-6 col-md-6" id="from_leg_narrative_flag_stop">
                    <div>
                        <h5> Flag Stop </h5>
                        {{#if (hasflexFlagStopPickupMessage)}}
                            {{flexFlagStopPickupMessage}}
                        {{else}}
                            {{flagStopPickupText}}
                        {{/if}}
                    </div>
                </span>
            {{/if}}
            {{#if (isCallAndRide from.boardAlightType) }}
                <span class="col-xs-6 col-md-6" id="from_leg_narrative_drt_pickup_message">
                    <div>
                        <h5> Service note: </h5>
                        {{#if (hasflexDrtPickupMessage) }}
                            {{flexDrtPickupMessage}}
                        {{else}}
                            {{deviatedRouteText}}
                        {{/if}}
                    </div>
                </span>
            {{/if}}
        </div>
        <br style="clear: both;">
        <div class="otp-legBody-to">
            {{#if (hasToTransitMessage) }}
                {{#if (hideDropoffDeviatedMessage) }}
                    <span class="col-xs-4 col-md-4" id="from_leg_narrative_depart">
                {{else}}
                    <span class="col-xs-2 col-md-2" id="from_leg_narrative_depart">
                {{/if}}

            {{else}}
                <span class="col-xs-4 col-md-4" id="from_leg_narrative_depart">
            {{/if}}
                <div>
                    <h5>Arrive</h5>
                    <div>
                        {{#if (hasflexCallAndRideMinEndTime) }}
                            <span class="timing_text"> approximately </span> {{formatTimeWithflexCallAndRideMinEndTime endTime flexCallAndRideMinEndTime timeOffset}}
                        {{else}}
                            {{formatTime endTime timeOffset}}
                        {{/if}}
                    </div>
                </div>
            </span>
            {{#if (hasToTransitMessage)}}
                {{#if (hideDropoffDeviatedMessage) }}
                    <span class="col-xs-8 col-md-8" id="from_leg_narrative_depart">
                {{else}}
                    <span class="col-xs-4 col-md-4" id="from_leg_narrative_from">
                {{/if}}

            {{else}}
                <span class="col-xs-8 col-md-8" id="from_leg_narrative_depart">
            {{/if}}
                <div>
                    <h5> To </h5>
                    <div>
                        {{to.name}}
                    </div>
                    {{#if to.stopId.id}}
                        <div>
                            Stop #{{to.stopId.id}}
                        </div>
                    {{/if}}
                </div>
            </span>
            {{#if (isFlagStop to.boardAlightType)}}
                <span class="col-xs-6 col-md-6" id="from_leg_narrative_flag_stop">
                    <div>
                        <h5> Flag Stop </h5>
                        {{#if (hasflexFlagStopDropOffMessage)}}
                            {{flexFlagStopDropOffMessage}}
                        {{else}}
                            {{flagStopDropOffText}}
                        {{/if}}
                    </div>
                </span>
            {{/if}}
            {{#if (isCallAndRide to.boardAlightType) }}
                {{#if (hideDropoffDeviatedMessage) }}
                {{else}}
                    <span class="col-xs-6 col-md-6" id="from_leg_narrative_drt_pickup_message">
                        <div>
                            <h5> Service note: </h5>
                            {{#if (hasflexDrtDropOffMessage) }}
                                {{flexDrtDropOffMessage}}
                            {{else}}
                                {{deviatedRouteText}}
                            {{/if}}
                        </div>
                    </span>
                {{/if}}
            {{/if}}
        </div>
    </div>
</div>
<br style="clear: both;">
<div></div>
